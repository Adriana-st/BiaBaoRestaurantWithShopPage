<style>
    body {
        background-color: #141414;
        color: #fff;
        padding-top: 100px;
        min-height: 100vh;
    }
</style>

<main class="container my-5">
    <div class="row">
        <div class="col-12">
            <h1 class="display-4 fw-bold text-warning mb-4">Shopping Cart</h1>
        </div>
    </div>

    <!-- Empty Cart Message -->
    <div id="emptyCart" class="text-center py-5">
        <div class="empty-cart-icon">ðŸ›’</div>
        <h3 class="text-light mt-4 mb-3">Your cart is empty</h3>
        <p class="text-muted mb-4">Add some delicious dishes to get started!</p>
        <a href="/shop" class="btn btn-warning btn-lg fw-bold">
            Browse Menu
        </a>
    </div>

    <!-- Cart Items -->
    <div id="cartItems" class="d-none">
        <div class="row">
            <!-- Cart Items List -->
            <div class="col-lg-8 mb-4">
                <div id="cartItemsList"></div>
            </div>

            <!-- Order Summary -->
            <div class="col-lg-4">
                <div class="card bg-dark border-warning">
                    <div class="card-header bg-warning text-dark">
                        <h4 class="mb-0 fw-bold">Order Summary</h4>
                    </div>
                    <div class="card-body">
                        <div class="d-flex justify-content-between mb-3">
                            <span class="text-light">Subtotal:</span>
                            <span class="text-light fw-bold">â‚¬<span id="subtotal">0.00</span></span>
                        </div>
                        <div class="d-flex justify-content-between mb-3">
                            <span class="text-light">Delivery Fee:</span>
                            <span class="text-light fw-bold">â‚¬<span id="deliveryFee">3.50</span></span>
                        </div>
                        <hr class="border-secondary">
                        <div class="d-flex justify-content-between mb-4">
                            <span class="text-warning fs-5 fw-bold">Total:</span>
                            <span class="text-warning fs-4 fw-bold">â‚¬<span id="totalAmount">0.00</span></span>
                        </div>
                        
                        <a href="/checkout" class="btn btn-warning w-100 btn-lg fw-bold mb-2">
                            Proceed to Checkout
                        </a>
                        <a href="/shop" class="btn btn-outline-warning w-100">
                            Continue Shopping
                        </a>

                        <div class="mt-4 pt-3 border-top border-secondary">
                            <p class="text-muted small mb-2">
                                <i class="bi bi-truck"></i> Free delivery on orders over â‚¬25
                            </p>
                            <p class="text-muted small mb-0">
                                <i class="bi bi-clock"></i> Estimated delivery: 30-45 minutes
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>

<!-- Cart Management Script -->
<script>
    // Load and display cart items
    function loadCart() {
        const cart = JSON.parse(localStorage.getItem('cart')) || [];
        const emptyCart = document.getElementById('emptyCart');
        const cartItems = document.getElementById('cartItems');
        const cartItemsList = document.getElementById('cartItemsList');

        if (cart.length === 0) {
            emptyCart.classList.remove('d-none');
            cartItems.classList.add('d-none');
            return;
        }

        emptyCart.classList.add('d-none');
        cartItems.classList.remove('d-none');

        // Generate cart items HTML
        let itemsHTML = '';
        cart.forEach((item, index) => {
            itemsHTML += `
                <div class="cart-item rounded p-3 mb-3">
                    <div class="row align-items-center">
                        <div class="col-md-2 col-3">
                            <img src="${item.image}" class="cart-item-image rounded" alt="${item.name}">
                        </div>
                        <div class="col-md-4 col-9">
                            <h5 class="text-warning mb-1">${item.name}</h5>
                            <p class="text-light mb-0 small">â‚¬${item.price.toFixed(2)} each</p>
                        </div>
                        <div class="col-md-3 col-6 mt-3 mt-md-0">
                            <div class="input-group">
                                <button class="btn btn-outline-warning btn-sm" 
                                        onclick="updateQuantity(${index}, -1)">-</button>
                                <input type="number" 
                                       class="form-control form-control-sm text-center text-white bg-dark border-warning" 
                                       value="${item.quantity}" 
                                       readonly>
                                <button class="btn btn-outline-warning btn-sm" 
                                        onclick="updateQuantity(${index}, 1)">+</button>
                            </div>
                        </div>
                        <div class="col-md-2 col-4 mt-3 mt-md-0 text-md-end">
                            <p class="text-warning fw-bold mb-0 fs-5">
                                â‚¬${(item.price * item.quantity).toFixed(2)}
                            </p>
                        </div>
                        <div class="col-md-1 col-2 mt-3 mt-md-0 text-end">
                            <button class="btn btn-outline-danger btn-sm" 
                                    onclick="removeItem(${index})"
                                    title="Remove item">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                    <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z"/>
                                    <path d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
            `;
        });

        cartItemsList.innerHTML = itemsHTML;
        updateTotals();
    }

    // Update quantity
    function updateQuantity(index, change) {
        let cart = JSON.parse(localStorage.getItem('cart')) || [];
        cart[index].quantity += change;

        if (cart[index].quantity <= 0) {
            cart.splice(index, 1);
        }

        localStorage.setItem('cart', JSON.stringify(cart));
        loadCart();
        window.dispatchEvent(new Event('cartUpdated'));
    }

    // Remove item
    function removeItem(index) {
        if (confirm('Remove this item from cart?')) {
            let cart = JSON.parse(localStorage.getItem('cart')) || [];
            cart.splice(index, 1);
            localStorage.setItem('cart', JSON.stringify(cart));
            loadCart();
            window.dispatchEvent(new Event('cartUpdated'));
        }
    }

    // Update totals
    function updateTotals() {
        const cart = JSON.parse(localStorage.getItem('cart')) || [];
        const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
        const deliveryFee = subtotal >= 25 ? 0 : 3.50;
        const total = subtotal + deliveryFee;

        document.getElementById('subtotal').textContent = subtotal.toFixed(2);
        document.getElementById('deliveryFee').textContent = deliveryFee.toFixed(2);
        document.getElementById('totalAmount').textContent = total.toFixed(2);

        // Update delivery fee text
        if (deliveryFee === 0) {
            document.getElementById('deliveryFee').parentElement.innerHTML = 
                '<span class="text-light">Delivery Fee:</span><span class="text-success fw-bold">FREE</span>';
        }
    }

    // Clear cart
    function clearCart() {
        if (confirm('Are you sure you want to clear your cart?')) {
            localStorage.removeItem('cart');
            loadCart();
            window.dispatchEvent(new Event('cartUpdated'));
        }
    }

    // Load cart on page load
    document.addEventListener('DOMContentLoaded', loadCart);
</script> 