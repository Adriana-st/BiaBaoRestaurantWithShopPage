<style>
    body {
        background: linear-gradient(135deg, #141414 0%, #5b0707 100%);
        color: #fff;
        padding-top: 100px;
        min-height: 100vh;
    }
</style>

<main class="container">
    <div class="row justify-content-center">
        <div class="col-md-6 col-lg-5">
            <div class="card border-warning bg-dark shadow-lg" >
                <div class="card-header bg-warning text-dark text-center py-3">
                    <h2 class="mb-0 fw-bold">Login to BiaBao</h2>
                </div>
                <div class="card-body p-4">
                    <!-- Login Error Alert -->
                    <div class="alert alert-danger d-none" role="alert" id="loginerror">
                        <strong>Login Failed!</strong> The username or password you entered is incorrect.
                    </div>

                    <!-- Login Form -->
                    <form name="login" id="user-login" method="get">
                        <div class="mb-4 text-light">
                            <label for="emailAddressID" class="form-label fw-semibold">
                                <i class="bi bi-envelope-fill text-warning"></i> Email Address
                            </label>
                            <input type="email" 
                                   class="form-control form-control-lg" 
                                   id="emailAddressID" 
                                   name="email" 
                                   value="admin@biabao.ie" 
                                   placeholder="Enter your email"
                                   required>
                            <small class="form-text" style="color: #adb5bd;">
                                Demo: admin@biabao.ie
                            </small>
                        </div>

                        <div class="mb-4 text-light">
                            <label for="passwordID" class="form-label fw-semibold">
                                <i class="bi bi-lock-fill text-warning"></i> Password
                            </label>
                            <input type="password" 
                                   class="form-control form-control-lg" 
                                   id="passwordID" 
                                   name="password" 
                                   value="biabao123" 
                                   placeholder="Enter your password"
                                   required>
                            <small class="form-text" style="color: #adb5bd;">
                                Demo: biabao123
                            </small>
                        </div>

                        <div class="form-check mb-4 text-light">
                            <input class="form-check-input" type="checkbox" id="rememberMe">
                            <label class="form-check-label" for="rememberMe">
                                Remember me
                            </label>
                        </div>

                        <div class="d-grid gap-2 mb-3">
                            <button type="submit" class="btn btn-warning btn-lg fw-bold">
                                <i class="bi bi-box-arrow-in-right"></i> Login
                            </button>
                        </div>

                        <div class="text-center">
                            <a href="/register" class="text-warning text-decoration-none fw-bold">
                                Need to Register?
                            </a>
                        </div>
                    </form>

                    <!-- Demo Credentials Info -->
                    <div class="mt-4 p-3 rounded text-light" style="background-color: rgba(255, 193, 7, 0.301); border: 1px solid rgba(255, 193, 7, 0.877);">
                        <h6 class="text-warning mb-2">
                            <i class="bi bi-info-circle-fill"></i> Demo Account
                        </h6>
                        <p class="mb-1 small">
                            <strong>Email:</strong> admin@biabao.ie
                        </p>
                        <p class="mb-0 small">
                            <strong>Password:</strong> biabao123
                        </p>
                    </div>
                </div>
            </div>

            <div class="text-center mt-4">
                <a href="/" class="btn btn-outline-light">
                    <i class="bi bi-arrow-left"></i> Back to Home
                </a>
            </div>
        </div>
    </div>
</main>

<!-- Login Script -->
<script>
    document.getElementById('user-login').addEventListener('submit', (event) => {
        event.preventDefault();
        
        const email = document.getElementById('emailAddressID').value.toLowerCase();
        const password = document.getElementById('passwordID').value;
        
        let loginSuccessful = false;
        let userData = null;
        
        // Check hardcoded admin account first
        if (email === "admin@biabao.ie" && password === "biabao123") {
            loginSuccessful = true;
            userData = {
                email: email,
                firstName: "Admin",
                lastName: "User",
                address1: "123 Food Street",
                address2: "Sligo",
                address3: "Co. Sligo",
                phone: "071 123 4567",
                dob: "1990-01-01",
                eircode: "F91 ABCD"
            };
        } else {
            // Check registered users from localStorage
            const users = JSON.parse(localStorage.getItem('registeredUsers')) || [];
            const user = users.find(u => u.email === email && u.password === password);
            
            if (user) {
                loginSuccessful = true;
                userData = user;
            }
        }
        
        if (loginSuccessful) {
            // Successful login
            localStorage.setItem('loggedIn', 1);
            localStorage.setItem('userEmail', email);
            
            // Save user details
            localStorage.setItem('userdetails', JSON.stringify({
                firstName: userData.firstName,
                lastName: userData.lastName,
                dob: userData.dob,
                phone: userData.phone,
                address1: userData.address1,
                address2: userData.address2,
                address3: userData.address3,
                eircode: userData.eircode || ""
            }));
            
            // Redirect to shop page
            window.location.href = "/shop";
        } else {
            // Login failed
            localStorage.setItem('loggedIn', 0);
            
            // Show error message
            const errorElement = document.getElementById("loginerror");
            errorElement.classList.remove("d-none");
            
            // Hide error after 5 seconds
            setTimeout(() => {
                errorElement.classList.add("d-none");
            }, 5000);
        }
    });

    // Check if already logged in
    window.addEventListener('DOMContentLoaded', () => {
        const loggedIn = localStorage.getItem('loggedIn');
        if (loggedIn == 1) {
            // Already logged in, redirect to shop
            window.location.href = "/shop";
        }
    });
</script>